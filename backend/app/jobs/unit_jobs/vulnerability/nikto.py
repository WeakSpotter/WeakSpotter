from app.jobs.abstract_job import Job
from app.jobs.container import run_container
from app.jobs.license import License


class NiktoJob(Job):
    requirements = ["domain"]
    key = "nikto"
    name = "Nikto Scan"
    license = License.GPLv2

    def run(self):
        """Performs a scan with Nikto on a domain or IP address."""
        domain = self._scan.data_dict.get("domain")

        self._raw_output = run_container(
            "ghcr.io/ozeliurs/nikto", f"nikto -h {domain} -Format xml -o -"
        )

    def parse_results(self):
        self.result = self._raw_output

    def score(self):
        return 0.0

    def definitions(self):
        return []
