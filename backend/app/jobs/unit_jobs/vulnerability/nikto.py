from app.jobs.abstract_job import Job
from app.jobs.container import run_container


class NiktoJob(Job):
    requirements = ["domain"]
    key = "nikto"
    name = "Nikto Scan"

    def run(self):
        """Performs a scan with Nikto on a domain or IP address."""
        domain = self._scan.data_dict.get("domain")

        self._raw_output = run_container("ghcr.io/ozeliurs/nikto", f"nikto -h {domain}")

    def parse_results(self):
        self.result = [
            line.strip()
            for line in self._raw_output.splitlines()
            if line.startswith("+")
        ]

    def score(self):
        return 0.0

    def definitions(self):
        return {}
